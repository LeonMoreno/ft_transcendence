(()=>{"use strict";const e=()=>'\n    <div class="d-flex justify-content-center align-items-center p-3 bg-dark">\n        <span class="text-white">CabraPing. All rights reserved ¬© 2023</span>\n    </div>\n  ';const t=`http://${new URL(window.location.href).hostname}:8000`;let n=null;const a=`http://${new URL(window.location.href).hostname}:8000`;async function i(){!async function(){const e=encodeURIComponent("http://localhost:8000/callback/");try{const t=await fetch(`${a}/auth42/config`);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);const n=await t.json();if(n){const t=n.UID,a=(n.SECRET,`https://api.intra.42.fr/oauth/authorize?client_id=${t}&redirect_uri=${e}&response_type=code`);window.location.href=a}}catch(e){}}()}!async function(){const{access_token:e,refresh_token:t}=function(){const e=new URLSearchParams(window.location.search);return{access_token:e.get("access_token"),refresh_token:e.get("refresh_token")}}();e&&t&&(!function(e,t){localStorage.setItem("jwt",e),localStorage.setItem("access_token",e),localStorage.setItem("refresh_token",t)}(e,t),window.history.replaceState({},document.title,"/"))}();function s(e,t){const n=document.getElementById("notification-container"),a=document.createElement("div");a.classList.add("text-white","p-2","rounded-3","m-2","shadow","d-inline-block","notification"),"success"===t?a.classList.add("bg-success"):a.classList.add("bg-danger"),a.textContent=e,n.appendChild(a),setTimeout((()=>{n.removeChild(a)}),3e3)}function o(e,t){const n=document.getElementById("notification-container");if(!n)return;const a=document.createElement("div");a.className="toast show align-items-center text-bg-primary border-0 mb-2",a.role="alert",a.ariaLive="assertive",a.ariaAtomic="true";const i=document.createElement("div");i.className="d-flex";const s=document.createElement("div");s.className="toast-body",s.textContent=`${e} ${t}`;const o=document.createElement("button");o.type="button",o.className="btn-close btn-close-white me-2 m-auto",o.ariaLabel="Close",o.addEventListener("click",(()=>{a.remove()})),i.appendChild(s),i.appendChild(o),a.appendChild(i),n.appendChild(a),setTimeout((()=>{a&&a.remove()}),5e3)}function r(){const e=localStorage.getItem("jwt");return e||(window.location.replace("/#auth"),null)}const c=()=>location.hash.slice(1).toLocaleLowerCase().split("/")[1]||"/";const d=`http://${new URL(window.location.href).hostname}:8000`;let l,u={},m=[],h=[],g=[],f="default",p=null,y=-1,b=-1,v=-1,w="general",I="general",E=null;async function S(){const e=localStorage.getItem("jwt");if(!e)return;y=C;const t=await fetch(`${d}/api/me/`,{headers:{Authorization:`Bearer ${e}`}});E=await t.json(),"user_not_found"!==E.code&&"token_not_valid"!==E.code||window.location.replace("/#logout"),f=E.username,g=await A(E.id),g.length>0&&(T(g),p=g[0].id,g.forEach((e=>{O(e.id)}))),x()}async function _(){const e=localStorage.getItem("jwt");if(!e)return;const t=e.split(".")[1],n=JSON.parse(atob(t));y=n.user_id;let a=c();w=a,"/"!=a&&(p=a);const i=await fetch(`${d}/api/me/`,{headers:{Authorization:`Bearer ${e}`}});E=await i.json(),"user_not_found"!==E.code&&"token_not_valid"!==E.code||window.location.replace("/#logout"),f=E.username,$(e);const o=document.getElementById("blockUserButton");o&&(o.disabled=!0,o.addEventListener("click",(()=>async function(e){if(y<0||b<0)return;const t=localStorage.getItem("jwt"),n=await fetch(`${d}/api/users-blocks/block/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({blocked_user_id:b})});j(-1),T(g),n.ok?s("User blocked successfully","success"):s("Failed to block user","error");$(t)}())));const r=document.getElementById("inviteGameButton");r&&(r.disabled=!0,r.addEventListener("click",(()=>async function(e){if(b<1)return;const t=await fetch(`${d}/api/games/`,{headers:{Authorization:`Bearer ${e}`}}),n=await t.json();if(n.find((e=>"PENDING"===e.invitationStatus&&(e.invitee.id===E.id&&e.inviter.id===b||e.inviter.id===E.id&&e.invitee.id===b))))return void s("There is already a pending game invitation","warning");const a=await fetch(`${d}/api/games/`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({invitationStatus:"PENDING",inviter:E.id,invitee:b})});a.ok?(s("Sent invitation","success"),pe(y,f,b,"sendGameInvataeNotifications")):s("Failed to invite user","error");const i=document.getElementById("inviteGameButton");i&&(i.disabled=!0)}(e))));const l=document.getElementById("usersRouteButton");l&&(l.disabled=!0,l.addEventListener("click",(()=>window.location.href=`#user/${b}`)));const u=document.getElementById("acceptGameButton");u&&(u.disabled=!0,u.addEventListener("click",(()=>async function(){const e=localStorage.getItem("jwt");if(!e)return;if("-1"===v&&-1===v)return;await fetch(`${d}/api/games/${v}/accept_game/`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});ye(y,f,b,v),window.location.href=`/#game/${v}`}())));const m=document.getElementById("addChannel");m&&m.addEventListener("click",N);const h=document.getElementById("sendButton");h&&(h.disabled=!0,h.addEventListener("click",k));const I=document.getElementById("saveChannelButton");I&&I.addEventListener("click",U);let S=C(e);g=await A(S),g.length>0&&(T(g),p=g[0].id,g.forEach((e=>{O(e.id)}))),x()}function B(e,t){if(!e.some((e=>String(e.id)===String(t))))return null;const n=JSON.parse(localStorage.getItem("id_active_users"))||[],a=e.filter((e=>n.includes(String(e.id))));return!(!a[0]||String(a[0].id)!==String(t))}async function x(){const e=localStorage.getItem("jwt");if(!e)return;const t=e.split(".")[1];let n=JSON.parse(atob(t)).user_id;const a=await fetch(`${d}/api/games/`,{headers:{Authorization:`Bearer ${e}`}}),i=await a.json(),s=i.find((e=>"PENDING"===e.invitationStatus&&(e.invitee.id===n||e.inviter.id===n)));if(s){v=s.id;const e=document.getElementById("inviteGameButton");e&&(e.disabled=!0)}const o=i.find((e=>e.invitee.id===n&&"ACCEPTED"===e.invitationStatus));o&&(window.location.href=`/#game/${o.id}`);i.find((e=>e.invitee.id===n&&"PENDING"===e.invitationStatus))}async function $(e){const t=await fetch(`${d}/api/users-blocks/blocked/`,{headers:{Authorization:`Bearer ${e}`}});h=await t.json();const n=await fetch(`${d}/api/users/`,{headers:{Authorization:`Bearer ${e}`}});m=await n.json();const a=document.getElementById("list-block");a&&(a.innerHTML="",h.forEach((e=>{const t=document.createElement("div");t.className="d-flex align-items-center mb-2";const n=document.createElement("img");n.src=e.avatarImageURL,n.alt="User Image",n.className="rounded-circle mr-2",n.width=40,n.height=40;const i=document.createElement("strong");i.textContent=e.username;const o=document.createElement("button");o.className="btn btn-primary btn-sm ml-auto",o.textContent="to unlock",o.addEventListener("click",(()=>async function(e){const t=localStorage.getItem("jwt"),n=await fetch(`${d}/api/users-blocks/unblock/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({blocked_user_id:e})});n.ok?(s("User unlocked successfully","success"),_()):s("Failed to unlock user","error")}(e.id))),t.appendChild(n),t.appendChild(i),t.appendChild(o),a.appendChild(t)})))}function k(){const e=document.getElementById("messageTextarea");if(e&&u[w]){const t=e.value;if(""!==t.trim()){let n={message:t,channel:w,UserName:f,userDetails:E};u[w].send(JSON.stringify(n)),e.value="",L(n)}}}function L(e){if(function(e){let t=JSON.parse(localStorage.getItem(`messages_channel_${e.channel}`))||[];t.push(e),localStorage.setItem(`messages_channel_${e.channel}`,JSON.stringify(t))}(e),e.channel===w){const t=document.getElementById("messageList");if(t){const n=document.createElement("div");n.className="mb-3 d-flex align-items-start";const a=document.createElement("img");a.src=`${e.userDetails.avatarImageURL}`,a.alt="User Image",a.className="rounded-circle mr-2",a.width=40,a.height=40;const i=document.createElement("div"),s=document.createElement("strong");s.textContent=e.UserName;const o=document.createElement("p");o.textContent=e.message,i.appendChild(s),i.appendChild(o),n.appendChild(a),n.appendChild(i),t.appendChild(n),t.scrollTop=t.scrollHeight}}else(function(e){return h.some((t=>t.id===e))})(e.userDetails.id)||o(e.UserName,"has sent you a message");x()}function N(){const e=document.getElementById("channelModal"),t=document.getElementById("channelMembers");e&&(e.style.display="block",fetch(`${d}/api/users/`).then((e=>e.json())).then((e=>{m=e,t.innerHTML="",e.forEach((e=>{if(e.username!=f){const n=document.createElement("option");n.textContent=e.username,n.value=e.id,t.appendChild(n)}}))})).catch((e=>{})));const n=document.getElementById("closeModalButton");n&&n.addEventListener("click",(()=>{e.style.display="none"}))}function T(e){const t=document.getElementById("chanelsLists");if(t){t.innerHTML="";const n=document.createElement("option");n.value=-1,n.textContent="Select a person for messages",t.appendChild(n),l=e,e.forEach((e=>{if(!e.members.some((e=>h.some((t=>t.id===e.id))))){const n=document.createElement("div");n.className="d-flex align-items-center p-2 border-bottom chat-item",n.style.cursor="pointer";const a=document.createElement("img");a.className="rounded-circle me-3",a.height=40,a.width=40;const i=document.createElement("p");i.className="mb-0",n.value=e.id;const s=e.members.find((e=>e.username!==f));s?(i.textContent=s.username,a.height=40,a.src=s.avatarImageURL):i.textContent="No disponible";let o=B(E.friends,s.id);if(n.appendChild(a),n.appendChild(i),"boolean"==typeof o){const e=document.createElement("p");e.style.height="20px",e.style.width="20px",e.className=!0===o?"mb-0 ms-3 rounded-circle bg-success":"mb-0 ms-3 rounded-circle bg-secondary",n.appendChild(e)}t.appendChild(n),n.addEventListener("click",(()=>j(e.id))),n.addEventListener("mouseover",(()=>{n.classList.add("bg-primary"),i.classList.add("text-white")})),n.addEventListener("mouseout",(()=>{n.classList.remove("bg-primary"),i.classList.remove("text-white")}))}}))}}function j(e){w=e;const t=document.getElementById("inviteGameButton"),n=document.getElementById("usersRouteButton"),a=document.getElementById("blockUserButton"),i=document.getElementById("sendButton"),s=document.getElementById("messageTextarea");if(document.getElementById("messageList").innerHTML="",-1===e){i&&(i.disabled=!0),n&&(n.disabled=!0),a&&(a.disabled=!0),t&&(t.disabled=!0),s&&(s.disabled=!0,s.placeholder="Select a channel to send messages"),u[w]&&(u[w].close(),delete u[w]);const e=document.getElementById("channel-title");e&&(e.textContent="No Channel Selected")}else{i&&(i.disabled=!1),n&&(n.disabled=!1),a&&(a.disabled=!1),t&&(t.disabled=!1),s&&(s.disabled=!1,s.placeholder="Enter your message here..."),u[e]||O(e);for(let t=0;t<l.length;t++)l[t].id==e&&P(l[t]);!function(e){const t=JSON.parse(localStorage.getItem(`messages_channel_${e}`))||[],n=document.getElementById("messageList");t.forEach((e=>{const t=document.createElement("div");t.className="mb-3 d-flex align-items-start";const a=document.createElement("img");a.src=`${e.userDetails.avatarImageURL}`,a.alt="User Image",a.className="rounded-circle mr-2",a.width=40,a.height=40;const i=document.createElement("div"),s=document.createElement("strong");s.textContent=e.UserName;const o=document.createElement("p");o.textContent=e.message,i.appendChild(s),i.appendChild(o),t.appendChild(a),t.appendChild(i),n.appendChild(t)})),n.scrollTop=n.scrollHeight}(e),x()}}function C(e){const t=e.split(".")[1];return JSON.parse(atob(t)).user_id}async function A(e){const t=await fetch(`${d}/user-channels/${e}/?format=json`);return await t.json()}function P(e){if(e.name===f){const t=e.members.find((e=>e.username!==f));I=t.username,b=t.id}else I=e.members.find((e=>e.username!==f)).username,b=e.members.find((e=>e.username!==f)).id;const t=document.getElementById("channel-title");t&&(t.textContent=`${I}`)}function O(e){if(u[e])return;const t=new WebSocket(`ws://127.0.0.1:8000/ws/chat/${e}/`);t.addEventListener("message",(e=>{L(JSON.parse(e.data))})),t.addEventListener("close",(()=>{delete u[e]})),u[e]=t}function U(){let e=document.getElementById("channelMembers").selectedOptions,t=Array.from(e).map((e=>parseInt(e.value,10)));t.push(y);const n=m.find((e=>e.id==t[0]))?.username||"Unknown User",a={owner:y,ownerId:y,name:n,status:"working",members:t},i=`${d}/channels/create/`,o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};fetch(i,o).then((e=>e.json())).then((e=>{e.name?(s("Channel successfully created","success"),A(y).then(T),function(e,t,n){if(!ne||ne.readyState!==WebSocket.OPEN)return;const a={type:"channel_created",message:"has created a new channel.",user_id:String(e),user_name:t,dest_user_id:String(n)};ne.send(JSON.stringify(a))}(y,f,t[0])):s("Error there is already a chat","error");const n=document.getElementById("channelModal");n&&(n.style.display="none")})).catch((e=>{s("Error there is already a chat","error")}))}const M=`http://${new URL(window.location.href).hostname}:8000`;let R={},z=[];async function J(){r();await D(),q(),H()}async function D(){const e=r(),t=await fetch(`${M}/api/me/`,{headers:{Authorization:`Bearer ${e}`}});if(R=await t.json(),!R)return null}async function q(){const e=r();await D();const t=document.getElementById("friends-list");if(!t)return null;t.innerHTML="";const n=R.friends||[];if(!Array.isArray(n))return null;if(n.length<=0)return t.innerHTML="<p>No friends yet</p>",null;const a=await fetch(`${M}/api/games/`,{headers:{Authorization:`Bearer ${e}`}}),i=await a.json();t.innerHTML=n.map((e=>{i.find((t=>t.inviter.id===R.id&&t.invitee.id===e.id&&"FINISHED"!==t.invitationStatus));const t=i.find((t=>t.invitee.id===R.id&&t.inviter.id===e.id&&"FINISHED"!==t.invitationStatus&&("PENDING"===t.invitationStatus||"ACCEPTED"===t.invitationStatus)));let n=B(R.friends,e.id),a="";return"boolean"==typeof n&&!0===n&&(a='<p class="mb-0 ms-3 rounded-circle bg-success" style="height: 20px; width: 20px;"></p>'),"boolean"==typeof n&&!1===n&&(a='<p class="mb-0 ms-3 rounded-circle bg-secondary" style="height: 20px; width: 20px;" ></p>'),`<li id="${e.id}" class="list-group-item d-flex gap-4 align-items-center">\n      <h3>${e.username}</h3>\n      ${a}\n      <button type="button" class="btn btn-sm btn-primary" data-action="invite-game"\n      data-id="${e.id}">Invite to a game</button>\n    ${t?`\n      <button type="button"\n        class="btn btn-sm btn-primary"\n        data-action="accept-game"\n        data-id="${t.id}">Accept to join the game</button>`:""}\n    </li>`})).join("");const s=document.querySelectorAll('[data-action="invite-game"]'),o=document.querySelectorAll('[data-action="accept-game"]');s.forEach((t=>{t.addEventListener("click",(async t=>{const n=Number(t.target.getAttribute("data-id"));await fetch(`${M}/api/games/`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({invitationStatus:"PENDING",inviter:R.id,invitee:n})});q(),H()}))})),o.forEach((t=>{t.addEventListener("click",(async t=>{const n=Number(t.target.getAttribute("data-id"));await fetch(`${M}/api/games/${n}/accept_game/`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});window.location.href=`/#game/${n}`,q(),H()}))}))}async function H(){const e=r(),t=document.getElementById("friend-requests-list");if(!t)return null;t.innerHTML="";const n=await fetch(`${M}/api/friend_requests/me`,{headers:{Authorization:`Bearer ${e}`}});if(z=await n.json(),z=z.filter((e=>{if(e.to_user.id===R.id)return e})),z.length<=0)return t.innerHTML="<p>No Friend Requests Yet</p>",null;const a=z.map((e=>`\n  <li id="${e.id}" class="list-group-item d-flex gap-4 align-items-center">\n      <h3>${e.from_user.username}</h3>\n    <div className="d-flex gap-4">\n      <button\n        type="button"\n        class="btn btn-sm btn-primary"\n        data-action="confirm"\n        data-from-id="${e.from_user.id}"\n        data-id="${e.id}">Confirm</button>\n        <button\n        type="button"\n        class="btn btn-sm btn-secondary "\n        data-action="delete"\n        data-from-id="${e.from_user.id}"\n        data-id="${e.id}">Delete</button>\n    </div>\n  </li>`)).join("");t.innerHTML=a;const i=document.querySelectorAll('[data-action="confirm"]'),s=document.querySelectorAll('[data-action="delete"]');i.forEach((t=>{t.addEventListener("click",(async t=>{const n=t.target.getAttribute("data-id"),a=t.target.getAttribute("data-from-id");await fetch(`${M}/api/friend_requests/${n}/`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({intent:"confirm"})}),q(),H(),function(e,t,n){if(!ne||ne.readyState!==WebSocket.OPEN)return;const a={type:"notify",message:"Send accept friend",user_id:String(e),user_name:t,dest_user_id:String(n)};ne.send(JSON.stringify(a))}(R.id,R.username,a)}))})),s.forEach((t=>{t.addEventListener("click",(async t=>{const n=t.target.getAttribute("data-id"),a=t.target.getAttribute("data-from-id");await fetch(`${M}/api/friend_requests/${n}/`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}});q(),H(),function(e,t,n){if(!ne||ne.readyState!==WebSocket.OPEN)return;const a={type:"notify",message:"Send accept friend",user_id:String(e),user_name:t,dest_user_id:String(n)};ne.send(JSON.stringify(a))}(R.id,R.username,a)}))}))}function W(){if(localStorage.getItem("jwt"))return'\n    <div class="container-sm min-vh-100">\n      <h2>List of Users</h2>\n      <ul id="users-list" class="list-group">\n        \x3c!-- userData --\x3e\n      </ul>\n    </div>\n  ';window.location.href="/#"}const F="http://localhost:8000";let G=[],Y=[],V=null;async function K(){const e=localStorage.getItem("jwt");if(!e)return null;const t=await fetch(`${F}/api/me/`,{headers:{Authorization:`Bearer ${e}`}});if(V=await t.json(),!V)return null;const n=await fetch(`${F}/api/users/`);if(G=await n.json(),!G)return null;const a=await fetch(`${F}/api/friend_requests/me`,{headers:{Authorization:`Bearer ${e}`}});Y=await a.json(),G=G.map((e=>{const t=Y.find((t=>t.to_user.id===e.id));return Boolean(t)?{...e,isSentFriendRequest:!0}:e}));const i=document.getElementById("users-list");if(!i)return;i.innerHTML=G.map((e=>{const t=e.id===V.id,n=e.friends.find((e=>e===V.id));let a=B(V.friends,e.id),i="";return"boolean"==typeof a&&!0===a&&(i='<p class="mb-0 ms-3 rounded-circle bg-success" style="height: 20px; width: 20px;"></p>'),"boolean"==typeof a&&!1===a&&(i='<p class="mb-0 ms-3 rounded-circle bg-secondary" style="height: 20px; width: 20px;" ></p>'),`\n  <li class="list-group-item d-flex gap-4 align-items-center">\n      <h3>${e.username}</h3>\n      ${i}\n      ${t||n||e.isSentFriendRequest?"":`<button\n              type="button"\n              class="btn btn-primary btn-sm"\n              data-action="create-friend-request"\n              data-id="${e.id}"\n              >Add Friend</button>`}\n\n      ${e.isSentFriendRequest?'<button\n              disabled\n              type="button"\n              class="btn btn-primary btn-sm"\n              >Added Friend</button>':""}\n\n      ${n?"<span>Your friend</span>":""}\n  </li>\n  `})).join("");document.querySelectorAll('[data-action="create-friend-request"]').forEach((t=>{t.addEventListener("click",(async t=>{const n=Number(t.target.getAttribute("data-id"));await fetch(`${F}/api/friend_requests/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({to_user:n})}),W(),K(),function(e,t,n){if(!ne||ne.readyState!==WebSocket.OPEN)return;const a={type:"notify",message:"Send friend request",user_id:String(e),user_name:t,dest_user_id:String(n)};ne.send(JSON.stringify(a))}(V.id,V.username,n)}))}))}function Q(e){const t=document.getElementById(e);t&&(t.style.display="none")}document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".modal .close").forEach((e=>{e.onclick=function(){Q(e.closest(".modal").id)}})),window.onclick=function(e){document.querySelectorAll(".modal").forEach((t=>{e.target==t&&Q(t.id)}))}}));const X=`http://${new URL(window.location.href).hostname}:8000`;function Z(e){const t=document.getElementById("waitingParticipantsList");if(t){t.innerHTML="",e.forEach((e=>{const n=e.username||"Unknown",a=e.accepted_invite?"Joined":"Waiting",i=document.createElement("li");i.textContent=`${n} - ${a}`,t.appendChild(i)}));const n=document.getElementById("startTournamentButton");if(n){const t=e.filter((e=>e.accepted_invite)).length>=4;n.disabled=!t}}}function ee(e){const{message:t,tournament_id:n}=e;o("Tournament canceled.",t),localStorage.removeItem("pageTournament"),localStorage.removeItem(`creatorUsername_${n}`),localStorage.removeItem("currentTournamentId"),setTimeout((()=>{window.location.href="/#"}),3e3)}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("startTournamentButton");e&&e.addEventListener("click",(async function(){const e=c()||null;if(e)try{(await fetch(`${X}/api/tournament/${e}/set_ready/`,{method:"POST",headers:{Authorization:`Bearer ${r()}`,"Content-Type":"application/json"},body:JSON.stringify({tournament_id:e,user_id:localStorage.getItem("userId")})})).ok}catch(e){}}));const t=document.getElementById("cancelTournamentButton");t&&t.addEventListener("click",(function(){const e=localStorage.getItem("currentTournamentId"),t=localStorage.getItem(`creatorUsername_${e}`);if(localStorage.getItem("username")===t){const t={type:"tournament_canceled",event:"tournament_canceled",message:"The tournament has been canceled by the creator.",tournament_id:e};ie[e]&&ie[e].send(JSON.stringify(t))}else o("Cancelation failed.","Only the creator can cancel the tournament.")}))}));const te=`http://${new URL(window.location.href).hostname}:8000`;let ne,ae=null,ie={};function se(e,t){switch(function(e,t){switch(e.event){case"channel_created":o(e.user_name,e.message),S();break;case"game_invite":"system"!==e.message?o(e.user_name,e.message):async function(e,t,n){let a=!1;const i=localStorage.getItem("jwt"),s=localStorage.getItem("update_waiting_list");if(!i||!s)return;const o=JSON.parse(s);if(o.length>=2)for(let n=0;n+1<o.length;n+=2)if(Number(o[n])===Number(e)&&Number(o[n+1])===Number(t)){a=!0;break}if(a)return;const r=i.split(".")[1];JSON.parse(atob(r)).user_id;const c=await fetch(`${te}/api/games/`,{headers:{Authorization:`Bearer ${i}`}}),d=(await c.json()).find((n=>n.invitee.id===Number(e)&&n.inviter.id===Number(t)&&"PENDING"===n.invitationStatus));if(d){(await fetch(`${te}/api/games/${d.id}/accept_game/`,{method:"PUT",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}})).ok,ye(e,n.userName,t,d.id),function(e,t){if(!ne||ne.readyState!==WebSocket.OPEN)return;const n={type:"delete_matched",matched_user_ids:[String(e),String(t)]};ne.send(JSON.stringify(n))}(e,t),window.location.href=`/#game/${d.id}`}}(e.dest_user_id,e.user_id,t);break;case"accepted_game":S(),window.location.href=`/#game/${e.message}`;break;default:!function(e){switch(e.message){case"Send friend request":case"Send accept friend":case"Send delete friend":J(),K(),S()}}(e)}}(e,t),e.event){case"accepted_invite":!function(e,t){Se(e.user_name,"accepted",!1),o(e.user_name,`Invitation accepted by ${e.user_name}.`),he(t)}(e);break;case"rejected_invite":!function(e,t){Se(e.user_name,"rejected",!1),o(e.user_name,`Invitation rejected by ${e.user_name}. Invite someone else or delete the tournament.`),he(t)}(e);break;case"game_invite":"tournament"===e.type?le(e,e.tournament_id):ue(e);break;case"tournament_invite":le(e,e.tournament_id);break;case"tournament_canceled":ee(e)}}function oe(e,t,n){const a=localStorage.getItem(`tournamentName_${e}`),i=localStorage.getItem("username"),s=localStorage.getItem("userId");if(ie[e]&&ie[e].readyState!==WebSocket.CLOSED){(function({tournamentId:e,event:t,type:n,dest_user_id:a}){const i=localStorage.getItem("userId"),s=localStorage.getItem("username")})({tournamentId:e,event:"game_invite",type:"tournament",dest_user_id:String(n)});!function(e,t,n,a,i){if(!ne||ne.readyState!==WebSocket.OPEN)return;const s={type:"tournament_invite",message:"You have been invited to join the tournament!",user_id:e,user_name:t,dest_user_id:n,tournament_id:a,tournament_name:i};ne.send(JSON.stringify(s))}(s,i,String(n),e,a)}else{const n=new WebSocket(`ws://localhost:8000/ws/tournament/${e}/`);n.onopen=function(){ie[e]=n,async function(){const n=localStorage.getItem("userId"),a=localStorage.getItem("username"),i=localStorage.getItem(`tournamentName_${e}`);const s=await re(t);if(!n||!s)return;const o={type:"tournament",event:"tournament_invite",user_id:n,message:`${a} is inviting you to join the tournament ${i}. Do you think you have what it takes to win the prestigious Ch√®vre Verte Award?`,user_name:a,dest_user_id:s,tournament_id:e,tournament_name:i};ie[e].send(JSON.stringify(o))}()},n.onmessage=function(t){me(JSON.parse(t.data),e)},n.onclose=function(t){delete ie[e]},n.onerror=function(e){}}}async function re(e){try{const t=await fetch(`${te}/api/users?username=${e}`,{headers:{Authorization:`Bearer ${r()}`,"Content-Type":"application/json"}});if(t.ok){const n=await t.json();if(Array.isArray(n)&&n.length>0){const t=n.find((t=>t.username===e));return t&&t.id?t.id:null}return null}return null}catch(e){return null}}async function ce(e,t){const n=await de(e),a=localStorage.getItem("userId"),i=n.find((e=>e.user.id.toString()===a));if(!i)return;const s=`${te}/api/participants/${i.id}/update_accepted_invite/`,c=JSON.stringify({accepted_invite:t});try{const e=await fetch(s,{method:"POST",headers:{Authorization:`Bearer ${r()}`,"Content-Type":"application/json"},body:c});if(!e.ok){return o("Error","Error updating invite status: "+await e.text()),!1}await e.json();return o("Success","Invite status updated successfully"),!0}catch(e){return o("Error","Network error: "+e.message),!1}}async function de(e){try{const t=await fetch(`${te}/api/tournaments/${e}/`,{headers:{Authorization:`Bearer ${r()}`,"Content-Type":"application/json"}});if(!t.ok)return null;return(await t.json()).participants||[]}catch(e){return null}}function le(e,t){const n=`${e.user_name} invited you to the ${e.tournament_name} tournament!`;document.getElementById("tournamentInviteMessage").innerText=n,ie[t]&&ie[t].readyState!==WebSocket.CLOSED||we(t),function(e){const t=document.getElementById(e);t&&(t.style.display="block")}("tournamentInviteModal"),document.getElementById("acceptTournamentInvite").onclick=async()=>{await ce(t,!0);!function(e,t){ie[e]&&ie[e].readyState===WebSocket.OPEN?xe(e,t):(we(e),ie[e].onopen=()=>{xe(e,t)})}(t,e.user_name),Q("tournamentInviteModal")},document.getElementById("rejectTournamentInvite").onclick=async()=>{await ce(t,!1);!function(e,t){ie[e]&&ie[e].readyState===WebSocket.OPEN?$e(e,t):(we(e),ie[e].onopen=()=>{$e(e,t)})}(t,e.user_name),Q("tournamentInviteModal")},Se(e.user_id,"invited",t)}function ue(e){o(e.user_name,`You have been matched to play a game! ${e.user_name}`)}async function me(e,t){let n=[];switch(e.event){case"game_invite":"tournament"===e.type?le(e,t):ue(e);break;case"accepted_invite":case"rejected_invite":case"user_connected":case"user_disconnected":case"update_user_list":n=await de(t),Z(n);break;case"all_ready":startTournament();break;case"tournament_canceled":ee(e)}}function he(e){const t=document.getElementById("startTournamentButton");checkAllParticipantsAccepted(e).then((e=>{t.disabled=!e}))}async function ge(){if(ne&&ne.readyState===WebSocket.OPEN)return;const e=localStorage.getItem("jwt");if(!e)return;if(!ae){const t=await fetch(`${te}/api/me/`,{headers:{Authorization:`Bearer ${e}`}});ae=await t.json()}const t=e.split(".")[1],n=JSON.parse(atob(t)).user_id;ne=new WebSocket(`ws://localhost:8000/ws/notifications/${n}/`),ne.onopen=function(){},ne.onmessage=function(e){const t=JSON.parse(e.data);switch(function(e,t){return String(e.dest_user_id)===t.toString()}(t,n)&&se(t,n),t.event){case"update_user_list":localStorage.setItem("id_active_users",JSON.stringify(t.user_ids)),S(),J(),K();break;case"update_waiting_list":localStorage.setItem("update_waiting_list",JSON.stringify(t.user_ids));let e=C(localStorage.getItem("jwt"));!async function(e,t,n){const a=e.waiting_ids;if(a.length>=2)for(let e=1;e<a.length;e+=2)if(a[e]===t){(await fe(t,a[e-1])).ok&&pe(t,n.userName,a[e-1],"system");break}}(t,String(e),ae)}},ne.onerror=function(e){},ne.onclose=function(e){ne=null}}async function fe(e,t){const n=localStorage.getItem("jwt");return await fetch(`${te}/api/games/`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({invitationStatus:"PENDING",inviter:e,invitee:t})})}function pe(e,t,n,a){if(!ne||ne.readyState!==WebSocket.OPEN)return;const i={type:"game_invite",message:a,user_id:String(e),user_name:t,dest_user_id:String(n)};ne.send(JSON.stringify(i))}function ye(e,t,n,a){if(!ne||ne.readyState!==WebSocket.OPEN)return;const i={type:"accepted_game",message:String(a),user_id:String(e),user_name:t,dest_user_id:String(n)};ne.send(JSON.stringify(i))}const be=`http://${new URL(window.location.href).hostname}:8000`;function ve(){const e=document.getElementById("tournamentNameInput").value;if(e){const t={tournamentName:e,participants:Array.from(document.getElementById("participantsList").children).map((e=>({name:e.textContent.split(" - ")[0],status:e.textContent.split(" - ")[1]})))};localStorage.setItem("pageTournament",JSON.stringify(t))}}function we(e){if(!ie[e]||ie[e].readyState===WebSocket.CLOSED){const t=new WebSocket(`ws://localhost:8000/ws/tournament/${e}/`);t.onopen=function(){ie[e]=t},t.onmessage=function(t){me(JSON.parse(t.data),e)},t.onclose=function(t){delete ie[e]},t.onerror=function(e){}}}async function Ie(e){e.preventDefault();const t=document.getElementById("participantNameInput").value.trim();if(!t)return void _e("Participant name cannot be empty.");if(t===localStorage.getItem("username"))return void _e("You cannot invite yourself to the party. Have some manners!");const n=localStorage.getItem("currentTournamentId");if(!n)return void _e("No tournament ID found. Please create a tournament first.");const a=await async function(e){try{const t=await fetch(`${be}/api/users/`,{headers:{Authorization:`Bearer ${r()}`,"Content-Type":"application/json"}});if(!t.ok)return _e("An error occurred while fetching users."),null;const n=(await t.json()).find((t=>t.username===e));if(!n)return _e("User not found. Please double-check their username."),null;const a=JSON.parse(localStorage.getItem("id_active_users"))||[];return a.includes(String(n.id))}catch(e){return _e("An error occurred while checking the user's online status."),null}}(t);if(null===a)_e("User not found. Please double-check their username.");else if(a){const e=await re(t);if(e){localStorage.getItem("jwt");let n=localStorage.getItem("currentTournamentId");!async function(e,t){const n=`${be}/api/tournaments/${e}/addparticipant/`,a=JSON.stringify({user_id:t});try{const e=await fetch(n,{method:"POST",headers:{Authorization:`Bearer ${r()}`,"Content-Type":"application/json"},body:a});if(!e.ok){return _e("Error adding participant: "+await e.text()),!1}await e.json();return s("Participant added successfully üá≤üáΩ","success"),!0}catch(e){return _e("Network error: "+e.message),!1}}(n,e),oe(n,t,e),Se({username:t},"invited")}else _e("Failed to get participant ID.")}else _e("Participant is not online.");document.getElementById("participantNameInput").value="",ve()}function Ee(e){if("keydown"===e.type&&"Enter"!==e.key)return;if(document.getElementById("addParticipantButton").disabled)return e.preventDefault(),void _e("Please create the tournament first before adding participants.");Ie(e),ve()}function Se(e,t,n=!1){const a="object"==typeof e?e.username||e.name:e,i=localStorage.getItem("username");if(a===i&&!n)return void _e("You cannot invite yourself to the party. Have some manners!");const o=document.getElementById("participantsList");if(o){const e=Array.from(o.children).find((e=>e.textContent.includes(a)));if(e)e.textContent=a+" - "+t,n||_e("This user has been invited already. Don't be pushy.");else{const e=document.createElement("li");e.textContent=n?a:a+" - invited",o.appendChild(e),n||s("Invitation successfully sent to "+a+".","success")}const i=o.children.length-1,r=document.getElementById("goToWaitingAreaButton");if(r){const e=i>=3;r.disabled=!e,localStorage.setItem("goToWaitingAreaButtonEnabled",e);const t=r.cloneNode(!0);r.parentNode.replaceChild(t,r),e&&t&&t.addEventListener("click",(()=>{const e=localStorage.getItem("currentTournamentId");ve(),window.location.href=`/#waitroom/${e}`}))}}}function _e(e){!function(e){const t=document.getElementById("notificationModal"),n=document.getElementById("modalMessage"),a=document.getElementById("closeModalButton");t&&n&&a&&(n.textContent=e,t.style.display="block",a.onclick=function(){t.style.display="none"})}(e)}async function Be(e){e.preventDefault();const t=document.getElementById("tournamentNameInput").value.trim();if(t){try{const e=await async function(e){try{const t=await fetch(`${be}/api/tournaments/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r()}`},body:JSON.stringify({name:e})});if(!t.ok){await t.text();throw new Error("Network response was not ok")}return t}catch(e){throw e}}(t);if(!e.ok){await e.text();throw new Error("Failed to create tournament. Server responded with an error.")}{const n=await e.json();s("Tournament created successfully","success"),document.getElementById("tournamentNameInput").value=t,document.getElementById("tournamentNameInput").disabled=!0,document.getElementById("tournamentForm").querySelector("button").disabled=!0,localStorage.setItem("currentTournamentId",n.id),localStorage.setItem(`tournamentName_${n.id}`,t),localStorage.setItem("creatorUsername_"+n.id,localStorage.getItem("username")),Se("You (Creator)","invited",!0),we(n.id);document.getElementById("addParticipantButton").disabled=!1}}catch(e){_e(e.message)}ve()}else _e("Tournament name cannot be empty.")}function xe(e,t){const n={type:"tournament",event:"accepted_tournament",message:`User ${t} accepted the tournament invitation for tournament ${e}`,user_id:localStorage.getItem("userId"),user_name:localStorage.getItem("username"),dest_user_id:t,tournament_id:e};ie[e].send(JSON.stringify(n));const a=document.getElementById("tournamentNameInput"),i=document.getElementById("participantsList");a&&i&&ve(),window.location.href=`/#waitroom/${e}`}function $e(e,t){const n={type:"tournament",event:"rejected_tournament",message:`User ${t} rejected the tournament invitation for tournament ${e}`,user_id:localStorage.getItem("userId"),user_name:localStorage.getItem("username"),dest_user_id:t,tournament_id:e};ie[e].send(JSON.stringify(n));document.getElementById("tournamentInviteModal").style.display="none"}function ke(){document.querySelectorAll("#logoutButton").forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),async function(){try{const e=await fetch("http://127.0.0.1:8000/api/logout/",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("jwt")}`,"Content-Type":"application/json"}});if(!e.ok)throw s("Error logging out user","error"),new Error("Logout failed");await e.json(),s("Successfully logged out","success"),localStorage.clear(),window.location.href="/login"}catch(e){s(e.message,"error")}}()}))}))}function Le(){document.addEventListener("DOMContentLoaded",(e=>{ke()}))}Le();const Ne=`http://${new URL(window.location.href).hostname}:8000`;const Te="http://localhost:8000";let je,Ce=null,Ae=null;async function Pe(){let e;e=await fetch(`${Te}/api/users/`,{headers:{Authorization:`Bearer ${je}`}});const t=await e.json();if(Ae)Ce=t.find((e=>e.id===parseInt(Ae)));else{const e=await fetch(`${Te}/api/me-full/`,{headers:{Authorization:`Bearer ${je}`}});Ce=await e.json()}Ce&&"user_not_found"!==Ce.code&&"token_not_valid"!==Ce.code?(document.getElementById("username").value=Ce.username,document.getElementById("first_name").value=Ce.first_name,document.getElementById("last_name").value=Ce.last_name,document.getElementById("avatarImage").src=Ce.avatarImageURL,document.getElementById("avatarImageURL").value=Ce.avatarImageURL,Ae&&(document.getElementById("username").disabled=!0,document.getElementById("first_name").disabled=!0,document.getElementById("last_name").disabled=!0,document.getElementById("avatarImageURL").disabled=!0,document.querySelector('button[type="submit"]').style.display="none")):window.location.replace("/#logout")}function Oe(e){e.preventDefault();const t=document.getElementById("username").value,n=document.getElementById("first_name").value,a=document.getElementById("last_name").value,i=document.getElementById("avatarImageURL").value;let o=new Object;t&&(o.username=t),n&&(o.first_name=n),a&&(o.last_name=a),i&&(o.avatarImageURL=i);const r={method:"PATCH",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("jwt")}`}};fetch(Te+"/api/user/update/"+Ce.id+"/",r).then((e=>e.ok?e.json():e.json().then((e=>Promise.reject(new Error(e.message||"Unknown error")))))).then((e=>{s("User successfully updated","success"),Pe()})).catch((e=>{s("Error updating user! "+e.message,"error")}))}const Ue=`http://${new URL(window.location.href).hostname}:8000`;new URL(window.location.href).hostname;function Me(){if(localStorage.getItem("jwt"))return'\n  <div class="container-fluid h-100 d-flex flex-column flex-md-row">\n    \x3c!-- Panel Izquierdo: Chat List --\x3e\n    <div class="bg-light p-3 d-md-block vh-100" style="flex: 0 0 25%;">\n      <h3>Chat</h3>\n      <div class="mb-4">\n        <h4 class="d-flex justify-content-between fs-5">\n          Messages with all\n          <button id="addChannel" class="btn btn-primary btn-sm">Add Channel</button>\n        </h4>\n        <div id="chanelsLists" class="chat-messages">\n            \x3c!-- Aqu√≠ se agregar√°n los mensajes --\x3e\n        </div>\n      </div>\n      <div class="mt-4">\n        <h3>Block users</h3>\n        <div id="list-block" class="">\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- Panel Medio: Chat Messages --\x3e\n    <div class="bg-white p-3 overflow-auto" style="flex-grow: 1;">\n      <h3 id="channel-title" class="mb-4">\n        Channel Title\n      </h3>\n      <button id="blockUserButton" class="btn btn-danger btn-sm ml-2">Block User</button>\n      <button id="usersRouteButton" class="btn btn-secondary btn-sm ml-2">User info</button>\n      <button id="inviteGameButton" class="btn btn-secondary btn-sm ml-2">Invite to a game</button>\n      <button id="acceptGameButton" class="btn btn-secondary btn-sm ml-2">Accept to join the game</button>\n      \x3c!-- Messages go here --\x3e\n      <ul id="messageList" class="list-unstyled overflow-auto v-75 " style="max-height: 48vh; min-height: 200px; ">\n        \x3c!-- Aqu√≠ se agregar√°n los mensajes --\x3e\n      </ul>\n      \x3c!-- Textarea for new messages --\x3e\n      <div class="mt-3">\n        <textarea id="messageTextarea" class="form-control" rows="3"></textarea>\n        <button id="sendButton" class="btn btn-primary mt-2">Send</button>\n      </div>\n    </div>\n\n  </div>\n\n    \x3c!-- Modal para crear un nuevo canal --\x3e\n    <div class="modal" tabindex="-1" role="dialog" id="channelModal">\n      <div class="modal-dialog" role="document">\n        <div class="modal-content">\n          <div class="modal-header">\n            <h5 class="modal-title">Create Channel</h5>\n            <button id="closeModalButton" type="button" class="close" data-dismiss="modal" aria-label="Close">\n              <span aria-hidden="true">&times;</span>\n            </button>\n          </div>\n          <div class="modal-body">\n\n            <p>Members</p>\n            <select multiple class="form-control" id="channelMembers"></select>\n\n          </div>\n          <div class="modal-footer">\n            <button type="button" id="saveChannelButton" class="btn btn-primary">Save Channel</button>\n          </div>\n        </div>\n      </div>\n    </div>\n    ';window.location.href="/#"}const Re="http://localhost:8000";const ze="http://localhost:8000";let Je=[],De=null;async function qe(){const e=localStorage.getItem("jwt");if(!e)return null;De=c()||null,"/"===De&&(De=null);const t=await fetch(`${ze}/api/users/`);let n;if(Je=await t.json(),De)n=Je.find((e=>e.id===parseInt(De)));else{const t=await fetch(`${ze}/api/me-full/`,{headers:{Authorization:`Bearer ${e}`}});n=await t.json()}const a=await fetch(`${ze}/api/games/`,{headers:{Authorization:`Bearer ${e}`}}),i=await a.json();if(!i)return null;const s=function(e){const t={};return e.forEach((e=>{const{inviter:n,invitee:a,winner:i}=e;t[n.id]||(t[n.id]={wins:0,losses:0,username:n.username}),t[a.id]||(t[a.id]={wins:0,losses:0,username:a.username}),i.id===n.id?(t[n.id].wins+=1,t[a.id].losses+=1):i.id===a.id&&(t[a.id].wins+=1,t[n.id].losses+=1)})),t}(i),o=function(e,t){let n={played:0,wins:0,losses:0};return t.forEach((t=>{const{inviter:a,invitee:i,winner:s}=t;a.id!==e.id&&i.id!==e.id||(n.played+=1,s.id===e.id?n.wins+=1:n.losses+=1)})),n}(n,i);Je=Je.map((e=>({...e,wins:s[e.id]?s[e.id].wins:0,losses:s[e.id]?s[e.id].losses:0}))),Je.sort(((e,t)=>t.wins-e.wins)),document.getElementById("selfstats").style.display="block",document.getElementById("avatarImageURL").src=n.avatarImageURL,document.getElementById("username").innerText=n.username,document.getElementById("first_name").innerText=n.first_name,document.getElementById("last_name").innerText=n.last_name,document.getElementById("played").innerText=o.played,document.getElementById("wins").innerText=o.wins,document.getElementById("losses").innerText=o.losses}async function He(){return'\n      <div class="stat-block" id="selfstats" style="display: none;">\n          <h3>Profile</h3>\n          <div class="d-flex align-items-start">\n              <img id="avatarImageURL" src="" class="rounded" alt="Avatar" style="max-width: 300px; height: 300px; object-fit: cover;">\n              <table class="table">\n                  <thead>\n                      <tr class="table-active">\n                          <th class="col-2">Username:</th>\n                          <td id="username"></td>\n                      </tr>\n                  </thead>\n                  <tbody>\n                      <tr>\n                          <th>First name:</th>\n                          <td id="first_name"></td>\n                      </tr>\n                      <tr class="table-active">\n                          <th>Last name:</th>\n                          <td id="last_name"></td>\n                      </tr>\n                      <tr>\n                          <th>Games played:</th>\n                          <td id="played"></td>\n                      </tr>\n                      <tr class="table-active">\n                          <th>Games won:</th>\n                          <td id="wins"></td>\n                      </tr>\n                      <tr>\n                          <th>Games lost:</th>\n                          <td id="losses"></td>\n                      </tr>\n                      <tr class="table-active">\n                          <th>Tournaments won:</th>\n                          <td>"Waiting for Rachel"</td>\n                      </tr>\n                  </tbody>\n              </table>\n          </div>\n      </div>\n    '}function We(){return'\n    <div class="container-sm min-vh-100 d-flex flex-column justify-content-center align-items-center">\n      <h2>Matching</h2>\n      <button id="start-matching-button" class="btn btn-primary mt-3">Start Matching</button>\n      <div id="matching-status" class="mt-3"></div>\n    </div>\n  '}const Fe=`http://${new URL(window.location.href).hostname}:8000`;async function Ge(){const e=r(),t=e.split(".")[1],n=JSON.parse(atob(t)).user_id,a=document.getElementById("start-matching-button"),i=document.getElementById("matching-status"),s=await fetch(`${Fe}/api/games/`,{headers:{Authorization:`Bearer ${e}`}});(await s.json()).find((e=>"PENDING"===e.invitationStatus&&(e.invitee.id===n||e.inviter.id===n)))?(a.disabled=!0,i.innerHTML='<p class="text-warning">You already have a pending game invitation.</p>'):(a.disabled=!1,i.innerHTML="",a.addEventListener("click",(async()=>{!function(e){if(!ne||ne.readyState!==WebSocket.OPEN)return;const t={type:"wait_matched",message:"You are now waiting for a match.",user_id:String(e)};ne.send(JSON.stringify(t))}(n),i.innerHTML='<p class="text-info">Looking for a match...</p>',a.disabled=!0})))}const Ye={"/":[function(){return'\n  <div class="container mt-5 min-vh-100">\n    <div class="row align-items-center">\n      \x3c!-- Imagen de Pong --\x3e\n      <div class="col-md-6">\n        <img src="assets/game.png" alt="Pong Game" class="img-fluid">\n      </div>\n\n      \x3c!-- Descripci√≥n y Bot√≥n --\x3e\n      <div class="col-md-6">\n        <h1>CabraPing</h1>\n        <p class="lead">Classic Pong: Bounce to Victory! Can you outmatch your opponent in this timeless arcade game of skill and reflexes?</p>\n        <button id="button-auth" class="btn btn-warning">42 Auth</button>\n        <a href="/#auth" class="btn btn-warning">Log In / Sign Up</a>\n      </div>\n    </div>\n  </div>\n  '},function(){let e=document.getElementById("button-auth");return e&&e.addEventListener("click",i),null}],"/auth":[function(){if(!localStorage.getItem("jwt"))return'\n    <div class="container mt-5">\n      <div class="row">\n        <div class="col-md-6">\n          \x3c!-- Login Form --\x3e\n          <form id="login-form">\n            <h2>Login</h2>\n            <div class="mb-3">\n              <label for="username" class="form-label">Email</label>\n              <input type="email" class="form-control" id="username" required>\n            </div>\n            <div class="mb-3">\n              <label for="password" class="form-label">Password</label>\n              <input type="password" class="form-control" id="password" required>\n            </div>\n            <button type="submit" class="btn btn-primary">Login</button>\n          </form>\n        </div>\n        <div class="col-md-6">\n          \x3c!-- Registration Form --\x3e\n\n          <form id="signup-form">\n          <h2>Create Account</h2>\n          \x3c!-- Add additional fields as per your user model --\x3e\n          <div class="mb-3">\n          <label for="new-username" class="form-label">Email</label>\n          <input type="email" class="form-control" id="new-username" required>\n          </div>\n          <div class="mb-3">\n          <label for="new-password" class="form-label">Password</label>\n          <input type="password" class="form-control" id="new-password" required>\n          </div>\n          <button type="submit" class="btn btn-success">Create Account</button>\n          </form>\n\n        </div>\n      </div>\n    </div>\n  ';window.location.href="/#"},function(){if(localStorage.getItem("jwt"))return void(window.location.href="/#");const e=document.getElementById("login-form"),t=document.getElementById("signup-form");e.addEventListener("submit",(e=>{e.preventDefault();!async function(e,t){try{const n=await fetch(`${Ne}/api/login/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(!n.ok){const e=await n.json();return void("User not found"===e.error?_e("You need to sign up before trying to sign in."):"Incorrect password"===e.error?_e("The password you entered is incorrect. Please try again."):_e(e.error||"Incorrect username or password"))}const a=await n.json();localStorage.setItem("jwt",a.access),localStorage.setItem("userId",a.user.id),localStorage.setItem("username",a.user.username),s("Successful login","success"),ke(),setTimeout((()=>{window.location.href="/#"}),500)}catch(e){_e("An error occurred during login. Have you signed up before trying to log in?")}}(document.getElementById("username").value,document.getElementById("password").value)})),t.addEventListener("submit",(e=>{e.preventDefault();!function(e,t){const n=e.split("@")[0];fetch("http://localhost:8000/api/users/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,email:e,password:t,avatarImageURL:"https://i.pinimg.com/736x/22/d8/71/22d8716223532ec51ea7b0ea471bbe67.jpg"})}).then((e=>{if(200===e.status||201===e.status)return e.json();throw new Error(`Server responded with status: ${e.status}`)})).then((e=>{s("User created successfully","success")})).catch((e=>{s("Error creating user! "+e.message,"error")}))}(document.getElementById("new-username").value,document.getElementById("new-password").value)}))}],"/logout":[Le],"/matching":[We,Ge],"/game":[We,Ge],"/game/:id":[function(){return'\n    <div class="container-fluid d-flex align-items-center justify-content-center mb-5 mt-5">\n      <div class="row w-100">\n        <section class="col-12 d-flex justify-content-center">\n          <div>\n            <header class="d-flex justify-content-between">\n              <h3>\n                <span>Player A: </span>\n                <span id="left-paddle-score">0</span>\n              </h3>\n              <h3>\n                <span>Game ID: </span>\n                <span id="game-id"> </span>\n              </h3>\n              <h3>\n                <span>Player B: </span>\n                <span id="right-paddle-score">0</span>\n              </h3>\n            </header>\n\n            <div class="bg-dark w-100 h-100 d-flex align-items-center justify-content-center p-5" >\n                <canvas id="game" class="w-100 h-100"></canvas>  \x3c!-- Canvas se ajusta al espacio disponible despu√©s del padding --\x3e\n            </div>\n          </div>\n        </section>\n      </div>\n    </div>\n  '},async function(){const e=r(),t=c();if("/"===t||"-1"===t)return;const n=await fetch(`${Ue}/api/games/${t}/`,{headers:{Authorization:`Bearer ${e}`}}),a=await n.json();if(document.getElementById("game-id").innerText=a.id,200!==n.status||"FINISHED"===a.invitationStatus)return;let i={...a.inviter,score:a?.inviterScore||0,canPlay:!1},s={...a.invitee,score:a?.inviteeScore||0,canPlay:!1};const o=new WebSocket(`ws://localhost:8000/ws/game/${a.id}/`);o.onopen=function(e){},o.onmessage=function(e){!function(e){e&&void 0!==e.rightPaddlePosition&&void 0!==e.leftPaddlePosition&&e.ballPosition&&(f.y=e.rightPaddlePosition,g.y=e.leftPaddlePosition,void 0!==e.ballPosition.x&&void 0!==e.ballPosition.y&&(p.x=e.ballPosition.x,p.y=e.ballPosition.y))}(JSON.parse(e.data).message)},o.onclose=function(e){e.wasClean},o.onerror=function(e){};const d=document.getElementById("game"),l=d.getContext("2d"),u=document.getElementById("left-paddle-score"),m=document.getElementById("right-paddle-score"),h=d.height-5-25;let g={x:10,y:d.height/2-12.5,width:5,height:25,dy:0},f={x:d.width-15,y:d.height/2-12.5,width:5,height:25,dy:0},p={x:d.width/2,y:d.height/2,width:5,height:5,resetting:!1,dx:.5,dy:-.5};function y(e,t){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function b(){const e={rightPaddlePosition:f.y,leftPaddlePosition:g.y,ballPosition:{x:p.x,y:p.y}};o.send(JSON.stringify(e))}document.addEventListener("keydown",(function(e){38===e.which?f.dy=-3:40===e.which&&(f.dy=3),87===e.which?g.dy=-3:83===e.which&&(g.dy=3),b()})),document.addEventListener("keyup",(function(e){38!==e.which&&40!==e.which||(f.dy=0),83!==e.which&&87!==e.which||(g.dy=0),b()})),requestAnimationFrame((async function n(){if(requestAnimationFrame(n),l.clearRect(0,0,d.width,d.height),g.y+=g.dy,f.y+=f.dy,g.y<5?g.y=5:g.y>h&&(g.y=h),f.y<5?f.y=5:f.y>h&&(f.y=h),l.fillStyle="white",l.fillRect(g.x,g.y,g.width,g.height),l.fillRect(f.x,f.y,f.width,f.height),p.x+=p.dx,p.y+=p.dy,p.y<5?(p.y=5,p.dy*=-1):p.y+5>d.height-5&&(p.y=d.height-10,p.dy*=-1),!p.resetting&&(p.x<0||p.x>d.width)){if(p.resetting=!0,p.x>d.width&&i.score++,p.x<0&&s.score++,u.innerText=i.score,m.innerText=s.score,3===i.score&&(a.winner=structuredClone(i)),3===s.score&&(a.winner=structuredClone(s)),a.winner.id){a.status="FINISHED";const n={winnerId:a.winner.id,inviterScore:i.score,inviteeScore:s.score};(await fetch(`${Ue}/api/games/${t}/finish_game/`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(n)})).json;return}setTimeout((()=>{p.resetting=!1,p.x=d.width/2,p.y=d.height/2}),400)}y(p,g)?(p.dx*=-1,p.x=g.x+g.width):y(p,f)&&(p.dx*=-1,p.x=f.x-p.width),l.fillRect(p.x,p.y,p.width,p.height),l.fillStyle="lightgrey",l.fillRect(0,0,d.width,5),l.fillRect(0,d.height-5,d.width,d.height);for(let e=5;e<d.height-5;e+=10)l.fillRect(d.width/2-2.5,e,5,5)}))}],"/chat":[Me,_],"/chat/:id":[Me,_],"/user":[function(){if(localStorage.getItem("jwt"))return'\n    <div class="container py-5">\n      <div class="row justify-content-center">\n        <div class="col-md-8 col-lg-6">\n          <form id="data-info" class="card shadow-sm">\n            <img id="avatarImage" src="" class="object-fit-scale card-img-top mh-50" alt="Avatar" style="max-height: 300px; object-fit: scale-down;">\n  \n            <div class="card-body">\n              <div class="mb-3">\n                <label for="username" class="form-label">Username</label>\n                <input type="text" class="form-control" id="username" placeholder="Username" required>\n              </div>\n              <div class="mb-3">\n                <label for="first_name" class="form-label">First Name</label>\n                <input type="text" class="form-control" id="first_name" placeholder="First Name" required>\n              </div>\n              <div class="mb-3">\n                <label for="last_name" class="form-label">Last Name</label>\n                <input type="text" class="form-control" id="last_name" placeholder="Last Name" required>\n              </div>\n              <div class="mb-3">\n                <label for="avatarImageURL" class="form-label">Avatar Image URL</label>\n                <input type="url" class="form-control" id="avatarImageURL" placeholder="Avatar URL">\n              </div>\n              <button type="submit" class="btn btn-primary w-100">Update</button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n    ';window.location.href="/#"},async function(){if(je=localStorage.getItem("jwt"),!je)return void(window.location.href="/#");Ae=c()||null,"/"===Ae&&(Ae=null),await Pe();const e=document.getElementById("data-info");e&&e.addEventListener("submit",Oe)}],"/users":[W,K],"/tournament":[async()=>{if(localStorage.getItem("jwt"))return'\n      \x3c!-- Tournament.html --\x3e\n      <div id="tournament" class="container mt-4 mb-6">\n          <h1>Create Tournament</h1>\n          <form id="tournamentForm" class="row g-3">\n              <div class="col-sm-7 col-md-6">\n                  <input type="text" id="tournamentNameInput" class="form-control" placeholder="Enter Tournament Name" required>\n              </div>\n              <div class="col-sm-5 col-md-4">\n                  <button type="submit" class="btn btn-primary w-100">Create Tournament</button>\n              </div>\n          </form>\n          <div id="participantInvitationSection" class="mt-4">\n              <h2>Register Participants</h2>\n              <div class="row g-3">\n                  <div class="col-sm-7 col-md-6">\n                      <input type="text" id="participantNameInput" class="form-control" placeholder="Enter Participant Nickname" required>\n                  </div>\n                  <div class="col-sm-5 col-md-4">\n                      <button id="addParticipantButton" class="btn btn-secondary w-100" disabled>Add Participant</button>\n                  </div>\n              </div>\n              <div style="height: 10px;"></div>\n              <h6>Participant list:</h6>\n              <ul id="participantsList" class="list-unstyled mt-2"></ul>\n          </div>\n          <button id="goToWaitingAreaButton" class="btn btn-success mt-3 mb-5" disabled>Go To Tournament Waiting Area</button>\n      </div>\n  \n      \x3c!-- Modal for notifications --\x3e\n      <div id="notificationModal" class="modal" tabindex="-1" role="dialog">\n          <div class="modal-dialog" role="document">\n              <div class="modal-content">\n                  <div class="modal-body">\n                      <p id="modalMessage"></p>\n                  </div>\n                  <div class="modal-footer">\n                      <button type="button" class="btn btn-secondary" id="closeModalButton">Close</button>\n                  </div>\n              </div>\n          </div>\n      </div>\n    ';window.location.href="/#"},function(){!function(){const e=JSON.parse(localStorage.getItem("pageTournament"));if(e&&e.tournamentName){const t=document.getElementById("tournamentNameInput"),n=document.getElementById("tournamentForm").querySelector("button"),a=document.getElementById("participantsList"),i=document.getElementById("addParticipantButton");t.value=e.tournamentName,t.disabled=!0,n.disabled=!0,a.innerHTML="",e.participants.forEach((e=>{const t=document.createElement("li");t.textContent=`${e.name} - ${e.status}`,a.appendChild(t)})),i.disabled=!1}}();const e=document.getElementById("tournamentForm");e&&e.addEventListener("submit",Be);const t=document.getElementById("addParticipantButton");t&&t.addEventListener("click",Ee);const n=document.getElementById("participantNameInput");n&&n.addEventListener("keydown",(e=>{"Enter"===e.key&&Ee(e),ve()}))}],"/waitroom/:id":[async function(){if(localStorage.getItem("jwt"))return'\n        <div id="waitingArea" class="container mt-4 mb-7">\n            <h1>Tournament Waiting Area</h1>\n            <div id="tournamentDetails">Waiting for more participants to join...</div>\n            <ul id="waitingParticipantsList" class="list-unstyled"></ul>\n            <button id="startTournamentButton" class="btn btn-success mt-3 mb-5" disabled>Let\'s Play!</button>\n            <button id="cancelTournamentButton" class="btn btn-danger mt-3 mb-5">Cancel Tournament</button>\n            <div style="height: 200px;"></div> \x3c!-- Spacer element --\x3e\n        </div>\n    ';window.location.href="/#"},async function(){const e=c()||null;if(!e)return;localStorage.getItem("creatorUsername_"+e);localStorage.getItem("username"),ie[e]&&ie[e].readyState!==WebSocket.CLOSED||we(e),setInterval((async()=>{const t=await de(e);Z(t),function(e){const t=c()||null;if(!t)return;const n=document.getElementById("startTournamentButton");!function(e){return e.every((e=>e.accepted_invite))}(e)?n.disabled=!0:(n.disabled=!1,n.dataset.listenerAttached||(n.addEventListener("click",(async function(){try{(await fetch(`${X}/api/tournament/${t}/set_ready/`,{method:"POST",headers:{Authorization:`Bearer ${r()}`,"Content-Type":"application/json"},body:JSON.stringify({tournament_id:t,user_id:userId})})).ok}catch(e){}})),n.dataset.listenerAttached=!0))}(t),function(){const e=document.getElementById("cancelTournamentButton");e.disabled=!1,e.dataset.listenerAttached||(e.addEventListener("click",(function(){const e=localStorage.getItem("currentTournamentId"),t=localStorage.getItem(`creatorUsername_${e}`);if(localStorage.getItem("username")===t){const t={type:"tournament_canceled",event:"tournament_canceled",message:"The tournament has been canceled by the creator.",tournament_id:e};ie[e]&&ie[e].send(JSON.stringify(t))}else o("Cancellation Failed","Only the creator can cancel the tournament.")})),e.dataset.listenerAttached=!0)}()}),5e3)}],"/logout":[Le],"/friends":[async function(){if(localStorage.getItem("jwt"))return'\n    <div class="container-sm min-vh-100">\n      <h2>All of My Friends</h2>\n      <ul id="friends-list" class="list-group">\n        \x3c!-- friendsData --\x3e\n        <p>No Friends Yet</p>\n      </ul>\n\n      <h2>Friend Requests</h2>\n      <p>We are the invitee</p>\n      <ul id="friend-requests-list" class="list-group">\n        \x3c!-- friendsData --\x3e\n        <p>No Friend Requests Yet</p>\n      </ul>\n    </div>\n  ';window.location.href="/#"},J],"/stats":[async function(){return'\n    <div class="container-sm min-vh-100">\n      <h2>Dashboard</h2>\n      <ul class="nav nav-tabs">\n        <li class="nav-item">\n          <a class="nav-link stat-nav-link" href="#" data-target="wins-losses">Leaderboard</a>\n        </li>\n        <li class="nav-item">\n          <a class="nav-link stat-nav-link" href="#" data-target="history">Match History</a>\n        </li>\n        <li class="nav-item">\n          <a class="nav-link stat-nav-link" href="#" data-target="selfstats">Personal Stats</a>\n        </li>\n      </ul>\n      <div class="stat-block" id="wins-losses" style="display: none;">\n        <h3>Wins and Losses</h3>\n        <table class="table table-bordered" id="wins-losses-table">\n          <tbody id="leaderboard"></tbody>\n        </table>\n      </div>\n      <div class="stat-block" id="history" style="display: none;">\n        <h3>Match History</h3>\n        <table class="table table-bordered" id="match-history-table">\n          <thead>\n            <tr>\n              <th class="table-dark">Winner</th>\n              <th class="table-dark">Loser</th>\n              <th class="table-dark">Time</th>\n              <th class="table-dark">Date</th>\n            </tr>\n          </thead>\n          <tbody id="history-list"></tbody>\n        </table>\n      </div>\n      <div class="stat-block" id="selfstats" style="display: none;">\n        <h3>Personal Stats</h3>\n        <div class="d-flex align-items-start">\n          <img id="avatarImageURL" src="" class="rounded" alt="Avatar" style="max-width: 300px; height: 300px; object-fit: cover;">\n          <table class="table">\n            <tbody>\n              <tr class="table-active">\n                <th class="col-2">Username:</th>\n                <td id="username"></td>\n              </tr>\n              <tr>\n                <th>First name:</th>\n                <td id="first_name"></td>\n              </tr>\n              <tr class="table-active">\n                <th>Last name:</th>\n                <td id="last_name"></td>\n              </tr>\n              <tr>\n                <th>Games played:</th>\n                <td id="played"></td>\n              </tr>\n              <tr class="table-active">\n                <th>Games won:</th>\n                <td id="wins"></td>\n              </tr>\n              <tr>\n                <th>Games lost:</th>\n                <td id="losses"></td>\n              </tr>\n              <tr class="table-active">\n                <th>Tournaments won:</th>\n                <td>Waiting for Rachel</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  '},async function(){const e=localStorage.getItem("jwt");if(!e)return null;try{const[t,n,a]=await Promise.all([fetch(`${Re}/api/me/`,{headers:{Authorization:`Bearer ${e}`}}),fetch(`${Re}/api/users/`),fetch(`${Re}/api/games/`,{headers:{Authorization:`Bearer ${e}`}})]),[i,s,o]=await Promise.all([t.json(),n.json(),a.json()]),r=function(e){const t={};return e.forEach((e=>{const{inviter:n,invitee:a,winner:i}=e;t[n.id]||(t[n.id]={wins:0,losses:0,username:n.username}),t[a.id]||(t[a.id]={wins:0,losses:0,username:a.username}),i.id===n.id?(t[n.id].wins+=1,t[a.id].losses+=1):i.id===a.id&&(t[a.id].wins+=1,t[n.id].losses+=1)})),t}(o),c=function(e,t){let n={played:0,wins:0,losses:0};return t.forEach((t=>{const{inviter:a,invitee:i,winner:s}=t;a.id!==e.id&&i.id!==e.id||(n.played+=1,s.id===e.id?n.wins+=1:n.losses+=1)})),n}(i,o);!function(e,t){const n=document.getElementById("leaderboard");n&&(n.innerHTML='\n    <tr class="table-dark">\n    <td class="col-1">Rank</th>\n    <td class="table-dark">Username</th>\n    <td class="table-dark">Wins</th>\n    <td class="table-dark">Losses</th>\n    <td class="table-dark">Tournament Wins</th>\n    </tr>\n    ',e.forEach(((e,a)=>{const i=t[e.id]||{wins:0,losses:0},s=a+1;n.innerHTML+=`\n      <tr class="table-dark">\n      <td class="col-1"># ${s}</td>\n      <td class="table-info">${e.username}</td>\n      <td class="table-success">${i.wins}</td>\n      <td class="table-warning">${i.losses}</td>\n      <td class="table-danger">waitin for Rachel</td>\n      </tr>\n      `})))}(s,r),function(e){const t=document.getElementById("history-list");t&&(t.innerHTML=e.map((e=>{const t=e.winner.username,n=e.winner.id===e.inviter.id?e.invitee.username:e.inviter.username,a=new Date(e.createdAt).toLocaleDateString();return`\n        <tr>\n        <td class="table-success">${t}</th>\n        <td class="table-warning">${n}</th>\n        <td class="table-light">${new Date(e.createdAt).toLocaleTimeString()}</th>\n        <td class="table-light">${a}</th>\n        </tr>\n        `})).join(""))}(o),function(e,t){document.getElementById("avatarImageURL").src=e.avatarImageURL,document.getElementById("username").innerText=e.username,document.getElementById("first_name").innerText=e.first_name,document.getElementById("last_name").innerText=e.last_name,document.getElementById("played").innerText=t.played,document.getElementById("wins").innerText=t.wins,document.getElementById("losses").innerText=t.losses}(i,c),document.querySelectorAll(".stat-nav-link").forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();const n=e.getAttribute("data-target");document.querySelectorAll(".stat-block").forEach((e=>{e.style.display="none"})),document.getElementById(n).style.display="block",document.querySelectorAll(".stat-nav-link").forEach((e=>e.classList.remove("active"))),e.classList.add("active")}))})),document.getElementById("wins-losses").style.display="block",document.querySelector('.stat-nav-link[data-target="wins-losses"]').classList.add("active")}catch(e){}}],"/profile":[He,qe],"/user/:id":[He,qe],"/404":[function(){return'\n    <div class="Error404 min-vh-100 d-flex flex-column align-items-center justify-content-center">\n      <h1 class="display-1 text-danger">404</h1>\n      <h2 class="mb-3">Page Not Found</h2>\n      <p class="text-muted mb-3">Cabraping apologizes but the page you are looking for does not exist.</p>\n      <a href="#/" class="btn btn-primary mt-2">Go to Home</a>\n    </div>\n    <style>\n      .Error404 {\n        background-color: #f8f9fa;\n        text-align: center;\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        min-height: 100vh;\n        padding: 0 20px; /* Add some padding for smaller screens */\n      }\n      .Error404 h1 {\n        font-size: 6rem;\n      }\n      .Error404 h2 {\n        font-size: 2rem;\n      }\n      .Error404 p {\n        font-size: 1.2rem;\n      }\n      .Error404 a {\n        text-decoration: none;\n        margin-top: 20px; /* Add space between the paragraph and the button */\n      }\n      @media (max-width: 768px) {\n        .Error404 h1 {\n          font-size: 4rem;\n        }\n        .Error404 h2 {\n          font-size: 1.5rem;\n        }\n        .Error404 p {\n          font-size: 1rem;\n        }\n      }\n      @media (max-width: 576px) {\n        .Error404 h1 {\n          font-size: 3rem;\n        }\n        .Error404 h2 {\n          font-size: 1.2rem;\n        }\n        .Error404 p {\n          font-size: 0.9rem;\n        }\n      }\n    </style>\n  '},function(){}]},Ve=async()=>{const a=document.getElementById("header"),i=document.getElementById("footer"),s=document.getElementById("content");i.innerHTML=await e(),a.innerHTML=await async function(){const e=localStorage.getItem("jwt"),a=Boolean(e);if(a){const a=await fetch(`${t}/api/me/`,{headers:{Authorization:`Bearer ${e}`}});n=await a.json(),"user_not_found"!==n.code&&"token_not_valid"!==n.code||window.location.replace("/#logout");const i=new WebSocket(`ws://localhost:8000/ws/users/${n.id}/`);i.onopen=function(e){},i.onmessage=function(e){const t=JSON.parse(e.data),n=document.getElementById("user-notification");"GAME_ACCEPTED"===t.status||"GAME_INVITED"===t.status?n.innerHTML=`\n        <div class="d-flex gap-2">\n          <span>${t.message}</span>\n          <a href="/#game/${t.game_id}" class="btn btn-sm btn-secondary">\n            Go to the game\n          </a>\n        </div>\n        `:n.innerText=t.message},i.onclose=function(e){e.wasClean},i.onerror=function(e){}}return`\n  <header id="nav" class="d-flex justify-content-between align-items-center p-3 bg-light">\n    <nav class="navbar navbar-expand-lg navbar-light">\n      <a class="navbar-brand" href="#">\n        <img src="assets/logo.svg" alt="Logo" style="height: 50px;">\n      </a>\n      \n      <button class="navbar-toggler" type="button" id="navbarToggle">\n        <span class="navbar-toggler-icon"></span>\n      </button>\n      \n      <div class="collapse navbar-collapse" id="navbarNav">\n        <ul class="navbar-nav">\n          ${a?'\n            <li class="nav-item"><a class="nav-link" href="#users">Users</a></li>\n            <li class="nav-item"><a class="nav-link" href="#friends">Friends</a></li>\n            <li class="nav-item"><a class="nav-link" href="#chat">Chats</a></li>\n            <li class="nav-item"><a class="nav-link" href="#game">Games</a></li>\n            <li class="nav-item"><a class="nav-link" href="#tournament">Tournament</a></li>\n            <li class="nav-item"><a class="nav-link" href="#stats">Dashboard</a></li>\n            <li class="nav-item"><a class="nav-link" href="#profile">Profile</a></li>\n          ':""}\n        </ul>\n      </div>\n    </nav>\n\n    <div>\n      ${a?`\n        <div class="d-flex gap-4">\n          <div id="user-notification">\n            \x3c!-- --\x3e\n          </div>\n\n          <a href="/#user" class="me-3 text-decoration-none text-dark">\n            <b>${n.username}</b>\n          </a>\n          <a href="/#logout" class="btn btn-primary" id="logoutButton">Logout</a>\n        </div>\n      `:'<a href="/#auth" class="btn btn-primary">Login</a>'}\n    </div>\n  </header>\n\n     `}(),function(){const e=document.getElementById("navbarToggle"),t=document.getElementById("navbarNav"),n=document.getElementById("nav");e&&t&&n&&e.addEventListener("click",(function(){t.classList.toggle("collapse"),n.classList.contains("d-flex")?n.classList.replace("d-flex","d-block"):n.classList.replace("d-block","d-flex")}))}();let o=location.hash.slice(1).toLocaleLowerCase().split("/"),r=function(e,t){let n,a;return a="/"!=c()?`/${t[0]}/:id`:`/${t[0]}`,n=e[a]&&t.length>=1&&t.length<=2?e[a]:e["/404"],n}(Ye,o);if(s.innerHTML=await r[0](),r.length>1)for(let e=1;e<r.length;e++)r[e]&&await r[e]();ke(),"chat"!==o[0]&&await S(),await ge()},Ke=Ve;window.addEventListener("load",Ve),window.addEventListener("hashchange",Ve),window.addEventListener("load",Ke),window.addEventListener("hashchange",Ke)})();